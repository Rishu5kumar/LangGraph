from langchain_google_genai import ChatGoogleGenerativeAI
from langchain_core.tools import tool
from langchain_community.tools import DuckDuckGoSearchRun
from langgraph.prebuilt import create_react_agent
from langchain.agents import create_agent
from langchain import hub
from dotenv import load_dotenv
import requests
import os

# --- Setup environment ---
os.environ['LANGCHAIN_PROJECT'] = 'ReAct Agent'
load_dotenv()

# --- Define tools ---
search_tool = DuckDuckGoSearchRun()

@tool
def get_weather_data(city: str) -> str:
    """
    Fetch the current weather data for a given city
    """
    url = f'https://api.weatherstack.com/current?access_key=f07d9636974c4120025fadf60678771b&query={city}'
    response = requests.get(url)
    return response.json()

# --- Define LLM ---
llm = ChatGoogleGenerativeAI(model="gemini-2.5-flash")

# --- Pull standard ReAct prompt from LangChain Hub ---
prompt = hub.pull("hwchase17/react")

# --- Create the ReAct Agent (no need for AgentExecutor) ---
agent = create_react_agent(
    llm=llm,
    tools=[search_tool, get_weather_data],
    prompt=prompt
)

# --- Run queries directly ---
response = agent.invoke({"input": "What is the current temperature of Gurgaon?"})

print("\nFinal Output:\n", response["output"])

'''
Optional: Using create_agent instead of create_react_agent

If you want to use the general agent builder, not just ReAct, you can write:

from langgraph.prebuilt import create_agent

agent = create_agent(
    model=llm,
    tools=[search_tool, get_weather_data],
    prompt=prompt
)


Both create_agent() and create_react_agent() return runnable objects that you can .invoke() or .stream() directly.
'''

# from langchain_google_genai import ChatGoogleGenerativeAI
# from langchain_core.tools import tool
# import requests
# from langchain_community.tools import DuckDuckGoSearchRun

# from langgraph.prebuilt import create_react_agent
# from langchain.agents import AgentExecutor

# from langchain import hub
# from dotenv import load_dotenv
# import os

# os.environ['LANGCHAIN_PROJECT'] = 'ReAct Agent'
# load_dotenv()

# search_tool = DuckDuckGoSearchRun()

# @tool
# def get_weather_data(city: str) -> str:
#   """
#   This function fetches the current weather data for a given city
#   """
#   url = f'https://api.weatherstack.com/current?access_key=f07d9636974c4120025fadf60678771b&query={city}'

#   response = requests.get(url)

#   return response.json()

# llm = ChatGoogleGenerativeAI(
#     model="gemini-2.5-flash"
# )

# # Step 2: Pull the ReAct prompt from LangChain Hub
# prompt = hub.pull("hwchase17/react")  # pulls the standard ReAct agent prompt

# # Step 3: Create the ReAct agent manually with the pulled prompt
# agent = create_react_agent(
#     llm=llm,
#     tools=[search_tool, get_weather_data],
#     prompt=prompt
# )

# # Step 4: Wrap it with AgentExecutor
# agent_executor = AgentExecutor(
#     agent=agent,
#     tools=[search_tool, get_weather_data],
#     verbose=True,
#     max_iterations=5
# )

# # What is the release date of Dhadak 2?
# # What is the current temp of gurgaon
# # Identify the birthplace city of Kalpana Chawla (search) and give its current temperature.

# # Step 5: Invoke
# response = agent_executor.invoke({"input": "What is the current temp of gurgaon"})
# print(response)

# print(response['output'])